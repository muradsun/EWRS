@{
}
<fieldset>
    <legend>
        Search Criteria
    </legend>
    <div class="tabbable">
        <ul class="nav nav-tabs active in">
            <li class="active">
                <a href="#tabUsers" data-toggle="tab"> Search  Users </a>
            </li>
            <li>
                <a aria-expanded="true" href="#tabGroups" data-toggle="tab"> Search Groups</a>
            </li>
        </ul>
        <div class="tab-content">
            <div class="tab-pane fade active in" id="tabUsers">
                <div class="row">
                    <div class="col-md-5">
                        <div class="form-group">
                            @*<label> First Name </label>*@
                            <input name="firstName" class="form-control input-sm" type="text" placeholder="Enter First Name" id="txtfirstName" />
                        </div>
                    </div>
                    <div class="col-md-5">
                        <div class="form-group">
                            <input name="lastName" class="form-control input-sm" type="text" placeholder="Enter Last Name" id="txtlastName" />
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-5">
                        <div class="form-group">
                            <input type="text" placeholder="Enter PF#" class="form-control input-sm" name="PF" id="txtPF" />
                        </div>
                    </div>
                    <div class="col-md-5">
                        <div class="form-group">
                            <input type="text" placeholder="Enter Title" class="form-control input-sm" name="Title" id="txtTitle" />
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-5">
                        <div class="form-group">
                            <input type="text" placeholder="Enter Email" class="form-control input-sm" name="Email" id="txtEmail" />
                        </div>
                    </div>
                    <div class="col-md-5">
                        <div class="form-group">
                            <input id="autocOH" placeholder="Enter Organization Name" class="form-control input-sm" name="autocOH" style="border-color: #aeacb4 !important;box-sizing: content-box;" />
                        </div>
                    </div>
                </div>
            </div>
            <div class="tab-pane fade" id="tabGroups">
                <div class="row">
                    <div class="col-md-5">
                        <div class="form-group">
                            <label> Group Name </label>
                            <input name="firstName" class="form-control input-sm" type="text" placeholder="Enter Group Name">
                        </div>
                    </div>
                    <div class="col-md-5">

                    </div>
                </div>
            </div>

        </div>
    </div>
    <a class="btn btn-primary" href="#" style="float:right" id="btnSearch">  <i class="fa fa-search"></i> Search </a>
</fieldset>

<fieldset>
    <legend>
        Search Results
    </legend>
    <table class="table table-striped" id="sample-table-3">
        <thead>
            <tr>
                <th></th>
                <th class="center">Photo</th>
                <th>Full Name</th>
                <th class="hidden-xs">PF No.</th>
                <th class="hidden-xs">Email</th>
                <th class="hidden-xs">Phone</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td colspan="6">
                    <div class="no-items-found" style="padding:1%">
                        <i class="fa fa-info-circle"></i> Start your Search
                    </div>
                </td>
            </tr>
            @*<tr>
                    <td class="center"><img class="img-rounded" alt="image" src="assets/images/avatar-1.jpg"></td>
                    <td>Peter Clark</td>
                    <td class="hidden-xs">UI Designer</td>
                    <td class="hidden-xs"><a href="#" target="_blank" rel="nofollow"> peter@example.com </a></td>
                    <td class="hidden-xs">(641)-734-4763</td>
                    <td class="center">
                        <div class="visible-md visible-lg hidden-sm hidden-xs">
                            <a title="" class="btn btn-transparent btn-xs" href="#" data-original-title="Edit" data-toggle="tooltip" data-placement="top"><i class="fa fa-pencil"></i></a>
                            <a title="" class="btn btn-transparent btn-xs tooltips" href="#" data-original-title="Share" data-toggle="tooltip" data-placement="top"><i class="fa fa-share"></i></a>
                            <a title="" class="btn btn-transparent btn-xs tooltips" href="#" data-original-title="Remove" data-toggle="tooltip" data-placement="top"><i class="fa fa-times fa fa-white"></i></a>
                        </div>
                        <div class="visible-xs visible-sm hidden-md hidden-lg">
                            <div class="btn-group dropdown ">
                                <button class="btn btn-primary btn-o btn-sm dropdown-toggle" type="button" data-toggle="dropdown">
                                    <i class="fa fa-cog"></i>&nbsp;<span class="caret"></span>
                                </button>
                                <ul class="dropdown-menu pull-right dropdown-light" role="menu">
                                    <li>
                                        <a href="#"> Edit </a>
                                    </li>
                                    <li>
                                        <a href="#"> Share </a>
                                    </li>
                                    <li>
                                        <a href="#"> Remove </a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </td>
                </tr>*@
        </tbody>
    </table>
    <div class="row">
        <div id="page-content-2" class="well">
            Page 1
        </div>
        <ul id="pagination-UsersGroups" class="pagination-sm"></ul>
    </div>
</fieldset>

<style type="text/css">
    .k-autocomplete {
        width: 100%;
        appearance: none;
        background-color: #FFFFFF !important;
        background-image: none !important;
        border: 1px solid #c8c7cc;
        border-radius: 0;
        color: #5b5b60 !important;
        font-family: inherit !important;
        font-size: 14px !important;
        padding: 5px 4px !important;
        box-shadow: none !important;
    }

    .k-itemx {
        background-color: #e8f5ff !important;
        padding: 5px !important;
        padding-left: 0 !important;
        font-weight: bolder;
        width: 100%;
    }
</style>
<script>
    var selectedOrgid = 0;
    $(document).ready(function () {
        var dataSource = new kendo.data.DataSource({
            serverFiltering: true,
            transport: {
                type: "json",
                serverFiltering: true,
                read: {
                    url: "/Project/SearchOrganizationHierarchy"
                },
                parameterMap: function (data, action) {
                    var newParams = {
                        filter: data.filter.filters[0].value
                    };
                    return newParams;
                }
            }
        });

        var autocomplete = $("#autocOH").kendoAutoComplete({
            minLength: 3,
            dataTextField: "orgname",
            dataSource: dataSource,
            headerTemplate: '',
            template: kendo.template($("#UserGroups-template").html()),
            select: function (ev) {
                var dataItem = this.dataItem(ev.item.index());
                selectedOrgid = dataItem.orgid;
            }

        }).data("kendoAutoComplete");

        $("#btnSearch").click(function () {
            var hrefText = $(".tabbable ul li.active a").attr("href");
            if (hrefText == "#tabUsers") {
                debugger;
                //Collect Data
                var dataForm = collectUserSearchData();
                $.ajax({
                    url: "/Account/SearchUsers",
                    success: function (result) {
                        //UsersRow-template
                        var htmlDataTemplate = kendo.template($("#UsersRow-template").html());
                        var htmlData = htmlDataTemplate(result);
                        $(".table tbody").html(htmlData);
                        //UINotifications.ShowToast("success", "Your Projet [ Text ] Saved Successfuly.", "Saved Successfuly");
                    },
                    cache: false,
                    dataType: 'json',
                    error: function (xhr, status, error) {
                        UINotifications.ShowToast("error", "Error Message: [ " + error + " ]", "Save Faild");
                    },
                    type: "POST",
                    data: JSON.stringify(dataForm),
                    contentType: "application/json"
                });
            }
            else
                if (hrefText == "#tabGroups") {

                }
                else {
                    alert('PLease Select a User or Groups Tab')
                }
        });
    });

    function collectUserSearchData() {
        //Collect Organization Data
        var autocomplete = $("#autocOH").data("kendoAutoComplete");
        if ($.trim(autocomplete.value()) == "")
            selectedOrgid = 0;

        return usersSearchRequestView = {
            PFNo: $("#txtPF").val(),
            FirstName: $("#txtfirstName").val(),
            FamilyName: $("#txtlastName").val(),
            Title: $("#txtTitle").val(),
            Email: $("#txtEmail").val(),
            OrganizationId: selectedOrgid
        };
    }
</script>

@*
          JASON obejct
    {
        "orgid": 12462,
        "orgname": "DAS CORPORATE SERVICES DEPARTMENT",
        "bU_NAME": "SENIOR MANAGEMENT",
        "diV_NAME": "DAS ISLAND ASSET",
        "deP_NAME": "DAS CORPORATE SERVICES DEPARTMENT",
        "teaM_NAME": null,
        "sectioN_NAME": null
      },*@


<script id="UserGroups-template" type="text/x-kendo-template">
    <div>
        <div class="k-itemx">
            ${ data.orgname }
        </div>
        <span><b>BU</b>  ${ data.bU_NAME }</span>  <br />
        <span><b>Div</b>  ${ data.diV_NAME }</span>  <br />
        <span><b>Dep</b>  ${ data.deP_NAME }</span>  <br />
        <span><b>Team</b>  ${ data.teaM_NAME }</span>  <br />
        <span><b>Sec</b>  ${ data.sectioN_NAME }</span>  <br />
    </div>
</script>
<script id="UsersRow-template" type="text/x-kendo-template">
    # for (var i = 0; i < data.length; i++) { #
        <tr>
            <td class="center">
                <
                ${ data[i].user_Id }
            </td>
            <td class="center"><img class="img-rounded" alt="image" src="/assets/images/avatar-1.jpg"></td>
            <td>${ data[i].employeeName } (${ data[i].pfNo })</td>
            <td class="hidden-xs">${ data[i].organizationHierarchyText }</td>
            <td class="hidden-xs"><a href="mailto:${ data[i].email }" target="_blank" rel="nofollow"> ${ data[i].email } </a></td>
            <td class="hidden-xs">  ${ data[i].title }  </td>
        </tr>
        # } #
</script>
